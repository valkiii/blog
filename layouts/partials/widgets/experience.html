{{ $page := .page }}

<div class="row">
  <div class="col-12">
    <h2 class="mb-5 text-center">{{ $page.Title }}</h2>
    <div class="timeline">
      {{ range $idx, $item := $page.Params.experience }}
        <div class="timeline-item">
          <div class="timeline-marker"></div>
          <div class="timeline-content {{ if modBool $idx 2 }}timeline-content-left{{ else }}timeline-content-right{{ end }}">
            <div class="experience-card {{ $item.extra_classes }}" onclick="toggleDescription(this)">
              {{ if $item.company_logo }}
                {{ $image := resources.Get (printf "media/icons/brands/%s" $item.company_logo) }}
                {{ if $image }}
                  <img src="{{ $image.RelPermalink }}" alt="{{ $item.company }} logo" class="company-logo">
                {{ end }}
              {{ end }}
              <h3 class="experience-title">{{ $item.title | markdownify | emojify }}</h3>
              <div class="experience-company">
                {{- if $item.company_url -}}
                  <a href="{{ $item.company_url }}" target="_blank" rel="noopener">{{ $item.company | markdownify | emojify }}</a>
                {{- else -}}
                  {{ $item.company | markdownify | emojify }}
                {{- end -}}
              </div>
              <div class="experience-location">{{ $item.location | markdownify | emojify }}</div>
              <div class="experience-date">
                {{ if $item.date_end }}
                  {{ (time $item.date_start).Format ($page.Params.date_format | default "January 2006") }} –
                  {{ (time $item.date_end).Format ($page.Params.date_format | default "January 2006") }}
                {{ else }}
                  {{ (time $item.date_start).Format ($page.Params.date_format | default "January 2006") }} –
                  {{ i18n "present" | default "Present" }}
                {{ end }}
              </div>
              <div class="experience-description" style="display: none;">
                {{ $item.description | markdownify | emojify }}
              </div>
              <div class="experience-expand">+</div>
            </div>
          </div>
        </div>
      {{ end }}
    </div>
  </div>
</div>

<script>
function toggleDescription(element) {
  var card = element.closest('.experience-card');
  var description = card.querySelector('.experience-description');
  var expandButton = card.querySelector('.experience-expand');
  
  if (description.style.display === 'none') {
    description.style.display = 'block';
    expandButton.textContent = '-';
    card.classList.add('expanded');
  } else {
    description.style.display = 'none';
    expandButton.textContent = '+';
    card.classList.remove('expanded');
  }
}
</script>